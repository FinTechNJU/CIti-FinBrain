# 需求规格说明书 

## 目录

[TOC]

## 更新历史

| 修改人员 | 日期    | 变更原因 | 版本号 |
| -------- | ------- | -------- | ------ |
| 顾琦琪   | 2018.07 | 创建文档 | 1.0    |
| 邱浩旻   | 2018.09 | 更新文档 | 2.0    |

## 1.引言

### 1.1 目的

本文档描述了`A+Quant：基于机器学习的资产量化管理系统`的功能需求和非功能需求。开发小组的软件系统实现与验证工作都以此文档为依据。

除特殊说明之外，本文档所包含的需求都是高优先级需求。

### 1.2 范围

A+Quant系统是为个人投资者开发的业务系统，开发的目标是帮助该个人投资者在股票、债券和商品三大类资产中进行配置。

通过A+Quant系统的应用，期望为个人投资者配置资产，自动调仓，在一般情况下帮助其获得超过当时银行利率的收益。


### 1.3 参考文献

1. IEEE标准



## 2.总体描述

### 2.1 商品前景

#### 2.1.2 背景与机遇

首先，传统投顾一对一人工服务，仅针对高净值人群、投资门槛高、管理费率高等特点难以满足快速变化的客户群体及需求。其次，由于上述原因，越来越多的金融机构引入称为“智能投顾”的解决方案。

A+Quant系统是一个智能投顾系统，是为个人投资者的需求开发的，它包括一个Web服务器。Web服务器将所有用户数据和一部分金融数据存储起来进行维护，另一部分金融数据通过在线API获取。用户通过桌面Web端或手机PWA客户端完成日常工作，Web端或PWA客户端与Web服务器采用实时通信的方式完成数据交换。

#### 2.1.2 业务需求

- **BR1:**~~在系统使用六个月后，商品积压、缺货和报废的现象要减少50%。~~
- ~~**BR2:**在系统使用六个月后，财务人员和总经理的工作效率提高50%。~~
- ~~**BR3:**在系统使用六个月后，销售额度提高20%，最好情况：40%，最可能情况：20%，最坏情况：10%。~~

### 2.2 产品功能

- **SF1:**~~分析商品库存，发现可能的商品积压、缺货和报废现象，及时报溢报损~~
- ~~**SF2:**根据市场变化调整销售的商品~~
- ~~**SF3**:处理商品入库与出库~~ 
- ~~SF4:发展客户，管理客户信息~~
- ~~SF5:记录并且管理进货、退货、退货~~
- ~~SF6:管理公司银行账户~~
- ~~SF7:清算与客户间的账目和公司的现金消费事宜~~
- ~~SF8:展示公司的销售状况、经营历程和经营情况~~
- ~~SF9:帮助总经理审批单据~~
- ~~SF10:制定促销手段进行销售竞争~~
- ~~SF11:掌握员工变动和授权情况~~

### 2.3 用户特征

| 用户         | 用户特征                                                     |
| :----------- | :----------------------------------------------------------- |
| 库存管理人员 | ~~公司大概有1~2名库存管理人员，他们负责根据公司的经营情况和策略对商品分类和商品的信息进行管理；通过查看库存变动，盘点库存快照来掌握仓库内货物的情况；通过制定库存报溢/报损单保持现实库存与系统内库存的一致。他们能够简单使用办公信息化系统，并且希望新系统不要增加现有工作量。~~ |

### 2.4 约束

- CON1：~~系统将部署Linux Server上~~
- CON2：系统使用Web界面

### 2.5 假设和依赖

- AE1：用户会准确的填写预期收益和风险情况，以便给出合适的投资组合推荐
- AE2：大类资产评价体系和多因子评价体系能合适的对每一项资产在一定时间段的表现给出评价
- AE3：使用不同资产配置策略模型对应的其他重要的假设



## 3.详细需求描述

### 3.1 对外接口需求

#### 3.1.1 用户界面

- 参考[界面原型](https://pro.modao.cc/app/5fUKGNJjO0DibEhk1DhNn1cQbxPThbK)

#### 3.1.2 通信接口

- CI：~~客户端与服务器使用RMI的方式进行通信。~~	

------

### 3.2 用例和功能需求

#### 3.2.1 用户注册并填写问卷 ####

- **特性描述**：未经注册的用户必须先注册并填写相关信息并登录才能开始使用系统。

- **优先级**：高

- **功能需求和刺激-响应序列**：

  **SR1-1: SignUp**

  ~~刺激：库存管理人员选择一个商品分类~~
  ~~响应：系统显示所选商品分类信息~~


#### 3.2.2 用户登录

- **特性描述：**已经注册的用户必须登录才能开始使用系统。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR2-1:  Signin.Valid**

  刺激：用户输入正确的用户名和密码的组合
  响应：系统跳转到用户的首页

  **SR2-2: Signin.Invalid**

  刺激：用户输入错误的用户名和密码的组合
  响应：系统提示用户”用户名和密码错误“

  **SR2-3: Signin.Forget.Mail**

  刺激：用户点击忘记密码
  响应：系统向用户注册时预留的邮发送重置密码的邮件

  **SR2-4: Signin.Forget.Reset**

  刺激：用户点击重置密码邮件中的链接
  响应：系统打开重置密码的页面

  **SR2-5: Signin.Forget.Valid**

  刺激：用户重复输入两遍一致的新密码
  响应：系统提示用户重置密码成功，并跳转至登录页面

  **SR2-6: Signin.Forget.Invalid**

  刺激：用户重复输入两遍新密码，但不一致
  响应：系统提示用户两遍输入不一致，请重新输入。


#### 3.2.3 用户修改个人信息

- **特性描述：**已经登录的用户可以修改个人信息。

- **优先级：**高

- **相关功能需求和刺激／相应序列：**

  刺激：进货人员请求制定进货单
  响应：系统自动为该进货单生成编号

#### 3.2.4 用户管理资产账户列表

- **特性描述：**在用户登录之后，用户可以管理已购买的资产账户列表。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR4-1: Account.Show**

  刺激：用户查看资产账户列表
  响应：系统展示用户所购的资产账户、系统推荐的资产账户以及创建资产账户的按钮

  **SR4-2: Account.Create.Input**

  刺激：用户点击创建新的资产账户
  响应：系统提示用户输入投资金额，投资年限、投资收益率和投资风险。其中投资收益率和投资风险已经根据之前用户的问卷填入了默认值。

  **SR4-3: Account.Create.Confirm**

  刺激：用户确认投资金额，输入投资年限、投资收益率和投资风险
  响应：系统跳转至用户资产账户列表界面，并在用户所购的资产账户末尾，系统推荐的资产账户之前添加一个未购入的资产账户。系统产生一个提示用户买入未买入的资产账户的通知。

  **SR4-4: Account.Remove.Warn**

  刺激：用户删除一个未买入的资产账户
  响应：系统提示用户是否删除

  **SR4-5: Account.Remove.Success**

  刺激：用户确认删除一个未买入的资产账户
  响应：系统提示用户删除成功

#### 3.2.5 用户买入和赎回资产账户

- **特性描述：**在用户登录之后，用户可以买入资产账户列表中未买入的资产账户和推荐的资产账户，可以赎回已买入的资产账户。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR5-1: Account.Purchase.Warn**

  刺激：用户预览未买入的资产账户或推荐的资产账户时进行初始交易
  响应：系统展责任条款，并提示用户是否继续

  **SR5-2: Account.Purchase.Call**

  刺激：用户选择继续进行初始交易
  响应：系统调用花旗API从用户绑定的花旗银行的银行卡上转用户设置的本金到本系统专用的投资银行账户上，手续费由用户承担

  **SR5-3: Account.Purchase.Fail**

  刺激：花旗API提示从用户到本系统的转账失败
  响应：系统提示用户买入失败

  **SR5-4: Account.Purchase.Success**

  刺激：花旗API提示从用户到本系统的转账成功
  响应：系统提示用户买入成功

  **SR5-5: Account.Redeem.Warn**

  刺激：用户进行资产账户的设置时选择赎回资产账户
  响应：系统展责任条款，并提示用户是否继续

  **SR5-6: Account.Redeem.Call**

  刺激：用户选择继续进行初始交易
  响应：系统调用花旗API从本系统专用的投资银行账户上转用户本金和收益到用户绑定的花旗银行的银行卡上，手续费从这部分资金里扣除

  **SR5-7: Account.Redeem.Fail**

  刺激：花旗API提示从本系统到用户的转账失败
  响应：系统提示用户赎回失败

  **SR5-8: Account.Redeem.Success**

  刺激：花旗API提示从本系统到用户的转账成功
  响应：系统提示用户赎回成功

#### 3.2.6 用户查看资产账户总体表现

- **特性描述：**在用户登录之后，用户可以查看资产账户列表中未买入的资产账户和推荐的资产账户的总体表现。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR6-1: Account.Overview.Unpurchased**

  刺激：用户点击未买入的资产账户或推荐的资产账户
  响应：系统展示该资产账户配置方案的预期年化收益率，预期波动率，历史两年回测收益曲线，股票债券及商品市场的配比预览和配比详情，一组初始交易的列表和提示用户进行该初始交易的按钮。

  **SR6-2: Account.Overview.Purchased**

  刺激：用户点击买入的资产账户
  响应：系统展示该资产账户配置方案的累计收益、预期年化收益率、今日收益率、初始时间、初始投资额、从开始投资到现在的收益曲线，股票债券及商品市场的配比预览和配比详情，展示每次调仓配比变化的层叠柱状图和调仓历史。

#### 3.2.7 用户查看资产账户在股票市场上的表现

- **特性描述：**在用户登录之后，用户可以查看资产账户列表中已买入的资产账户在股票市场上的表现。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR7-1: Account.Stock**

  刺激：用户查看买入的资产账户的股票市场表现
  响应：系统展示该资产账户配置方案在股票市场投资的初始时间、当前总价值、当前总价值相对资产账户占比、当前持仓列表、最近交易列表。

  **SR7-2: Account.Stock.Performance**

  刺激：用户查看买入的资产账户的股票市场的业绩表现
  响应：系统展示该资产账户配置方案在股票市场的超额动态回撤和超额收益率。

  **SR7-3: Account.Stock.Attribution**

  刺激：用户查看买入的资产账户的股票市场的归因分析
  响应：系统展示该资产账户配置方案在股票市场投资的风格配置能力图，图中展示风格择时和风格选股对收益的贡献。

  **SR7-4: Account.Stock.Scenario**

  刺激：用户查看买入的资产账户的股票市场的情景分析
  响应：系统展示该资产账户配置方案在股票市场投资的市道切分表和因子敏感性分析图。市道切分表展示市场显著上升、市场震荡上升、市场显著下降和市场震荡下降和周期数、周收益率区间和场景收益占比。因子敏感性分析图展示不同波动率因子在线性拟合和曲线拟合下的标准化收益率。

#### 3.2.8 用户查看资产账户在债券市场上的表现

- **特性描述：**在用户登录之后，用户可以查看资产账户列表中已买入的资产账户在债券市场上的表现。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR8-1: Account.Bond**

  刺激：用户查看买入的资产账户的债券市场表现
  响应：系统展示该资产账户配置方案在信用债和利率债投资的初始时间、久期、当前收益率、当前总价值、当前总价值相对资产账户占比和当前持仓列表。

  **SR8-2: Account.Bond.Credit**

  刺激：用户查看买入的资产账户的债券市场的信用债深度分析
  响应：系统展示该资产账户配置方案的信用债估价表和信用债风险指标表。其中估价表给出每月的信用债估价，风险指标表给出每个季度的估价修正久期、资产负债率、现金流量比率和信用评级。

  **SR8-3: Account.Bond.Rate**

  刺激：用户查看买入的资产账户的债券市场的利率债深度分析
  响应：系统展示该资产账户配置方案的利率债估价表和利率债估价修正久期表。其中估价表给出每月的信用债估价，估价修正久期表给出利率债估价久期随季度的变化。

#### 3.2.9 用户查看资产账户在商品市场上的表现

- **特性描述：**在用户登录之后，用户可以查看资产账户列表中已买入的资产账户在商品市场上的表现。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR9-1: Account.Product**

  刺激：用户查看买入的资产账户的商品市场表现
  响应：系统展示该资产账户配置方案在原油期货和原油现货投资的初始时间、当前收益率、当前总价值、当前总价值相对资产账户占比和当前持仓列表。

  **SR9-2: Account.Product.Analysis**

  刺激：用户查看买入的资产账户的商品市场的深度分析
  响应：系统展示该资产账户配置方案的每日收益率走势图、组合收益率走势图、总收益率走势图、场景分析数据表、与市场基准的对比图、因子敏感性分析图和残差分析图。其中每日收益率走势图展示原油期货、现货及其组合的收益率随时间的走势，组合收益率走势图和总收益率走势图分别展示组合收益率和总收益率随日期的变化，场景分析数据表展示当前夏普比率、Calmar比率、最大周收益率、最小周收益率、波动率和最大回撤。与市场基准的对比图展示南方原油市场基准、南华指数市场基准和组合收益率随日期的变化。因子敏感性分析图展示不同波动率因子在线性拟合和曲线拟合下的标准化收益率。残差分析图展示残差随日期的变化。

#### 3.2.10 用户查看资产账户的交易记录

- **特性描述：**在用户登录之后，用户可以查看资产账户列表中已买入的资产账户的交易记录。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR10-1: Account.Transaction**

  刺激：用户查看买入的资产账户的交易记录
  响应：系统展示每日的交易记录表，表的每一行包括时间、种类、合约代码、买进或卖出、成交量、成交价和交易额。

#### 3.2.11 用户查看资产账户的持仓调仓情况

- **特性描述：**在用户登录之后，用户可以查看资产账户列表中已买入的资产账户的持仓调仓情况。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR11-1: Account.Position**

  刺激：用户查看买入的资产账户的持仓情况
  ~~响应：系统展示每日的交易记录表，表的每一行包括时间、种类、合约代码、买进或卖出、成交量、成交价和交易额。~~

  **SR11-2: Account.Position.Daily**

  刺激：用户查看买入的资产账户的每日持仓情况
  响应：系统展示每日持仓表，表的每一行包括日期、合约代码、当前价	、持有量、总额、盈亏和费用

  **SR11-3: Account.Reallocation**

  刺激：用户查看买入的资产账户的调仓记录
  响应：系统展示每日的调仓记录表，表的每一行包括每一次调仓的时间、股票配资比例和此次变化、基金配资比例和此次变化和商品市场配资比例和此次变化。

  **SR11-4: Account.Reallocation.Detail**

  刺激：用户查看买入的资产账户的调仓记录详情
  响应：系统展示此次调仓股票市场、债券市场和商品市场各个标的在上期和本期占整个资产账户的比例，以及上次配比的饼图和这次配比的饼图。

  **SR11-5: Account.Reallocation.Detail.Transaction**

  刺激：用户查看买入的资产账户的调仓记录详情
  响应：系统展示此次调仓股票市场、债券市场和商品市场的交易记录表，表的每一行包括时间、种类、合约代码、买进或卖出、成交量、成交价和交易额。	

#### 3.2.11 用户设置资产账户

- **特性描述：**在用户登录之后，用户可以配置资产账户列表中已买入的资产账户，以满足个性化自动交易。

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR11-1: Account.Setting.Plan**

  刺激：用户编辑资产账户的自动交易的时间点，提醒时间，自动交易交易额阈值和忽视手动确认交易时的默认操作并保存
  响应：系统静默保存

#### 3.2.12 系统调仓

- **特性描述：**~~?????~~

- **优先级：**高

- **功能需求和刺激-响应序列：**

  **SR12-1: Account.Reallocate**

  刺激：~~系统监测到，系统定时~~
  响应：~~系统发送通知~~

### 3.3 非功能需求

#### 3.3.1 安全性

- Safety1:系统应该只允许经过验证和授权的用户账户访问
- Safety2:系统通过OAuth2.0让一个用户账户绑定花旗银行卡


#### 3.3.2 可维护性

- ~~Modifiability1：如果系统要增加新的促销类型（例如商品折扣等），要能够在0.25个人月内完成。~~
- ~~Modifiability2：如果系统要增加新的促销类型（例如商品折扣等），要能够在0.25个人月内完成。~~
- ~~Modifiability3：如果系统要增加新的单据类型，要能够在0.25个人月内完成。~~

#### 3.3.3 易用性

- Usability1：系统要在计划交易之前，提前用户的自定义时长，在平台上和通过邮件提醒用户由计划交易。
- ~~Usability2：使用系统1个月的进货人员、库存管理人员、销售人员、财务人员制定单据的效率要达到0.1张单据／分钟。~~


#### 3.3.4 可靠性

- ~~Reliability1：在客户端与服务器通信时，如果网络故障，系统不能出现故障。~~
  - ~~Reliability1.1：客户端应该检测到故障，并尝试重新连接网络3次，每次15秒。~~
  - ~~Reliability1.1.1：重新连接后，客户端应该继续之前的工作。~~
  - ~~Reliability1.1.2：如果重新连接不成功，客户端应该提示等待5分钟，并在5分钟后再次尝试重新连接。~~
  - ~~Reliability1.1.2.1：重新连接后，客户端应该继续之前的工作。~~
  - ~~Reliability1.1.2.2：如果重新连接不成功，客户端报警。~~

#### 3.3.5 业务规则

- 

#### 3.3.6 约束

- CON1：~~系统将部署Linux Server上~~
- CON2：系统使用Web界面

------

### 3.4 数据需求

#### 3.4.1 数据定义

- ~~DR1：系统需要存储一年内的销售单据、库存单据、财务单据、进货单据。~~
- ~~DR2：系统删除之后的库存数据和客户数据仍然要继续存储3个月的时间，以保证历史数据显示的正确性。~~

#### 3.4.2 默认数据

- 默认资产账户自动交易设置
  - 交易时间点：15:00 UTC+8
  - 提前通知时长：1h
  - 手动确认交易额阈值：20,000 RMB
  - 默认操作等待时间：2h
  - 默认操作：确认交易

#### 3.4.3 数据格式要求

- ~~Format1：价格和费用等金额数据格式必须是大于等于0，精确到小数点后2位的浮点数，单位为元。~~
- ~~Format2：日期的格式必须为`yyyy-mm-dd`。~~
- ~~Format3：数量的格式必须为正整数。~~
- ~~Format4：进货单编号的格式必须为`JHD-yyyyMMdd-xxxxx`，后五位每天从 1 开始编号。~~
- ~~Format5：进货退货单编号的格式必须为`JHTHD-yyyyMMdd-xxxxx`，后五位每天从 1 开始编号。~~
- ~~Format6：销售单编号的格式必须为`XSD-yyyyMMdd-xxxxx`。~~
- ~~Format7：销售退货单编号的格式必须为`XSTHD-yyyyMMdd-xxxxx`。~~
- ~~Format8：收款单编号的格式必须为`SKD-yyyyMMdd-xxxxx`。~~
- ~~Format9：付款单编号的格式必须为`FKD-yyyyMMdd-xxxxx`。~~
- ~~Format10：现金费用单编号的格式必须为`XJFYD-yyyyMMdd-xxxxx`。~~

### 3.5 其他需求

#### 3.5.1 安装需求

- ~~Install1：在安装系统时，要初始化客户、库存等重要数据。~~
- ~~Install2：系统投入使用时，需要对用户进行一个星期的集中培训。~~